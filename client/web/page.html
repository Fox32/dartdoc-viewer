<!DOCTYPE html>
<link rel="import" href="item.html">
<link rel="import" href="homepage.html">
<link rel="import" href="library.html">
<link rel="import" href="class.html">
<link rel="import" href="method.html">
  
<element name="dartdoc-page" constructor="PageElement" extends="article"
    apply-author-styles>
  <template>
      
    <!-- Home -->
    <template if="currentRouteName == 'home'">
      <dartdoc-homepage home="{{app.viewer.homePage}}"></dartdoc-homepage>
    </template>

    <template if="app.viewer.homePage != null">
      
      <!-- Library -->
      <template if="currentRouteName == 'library'">
        <dartdoc-library 
          route="{{route.getRoute('libraryId')}}" libname="{{library}}">
        </dartdoc-library>
      </template>
        
      <!-- Method 
      <template instantiate="if page.currentPage is Method">
        <dartdoc-method method="{{page.currentPage}}"></dartdoc-method>
      </template>
      -->
     
    </template>

  </template>
  
  <script type="application/dart">
    import 'dart:html';
    
    import 'package:dartdoc_viewer/client.dart';
    import 'package:dartdoc_viewer/item.dart';
    import 'package:web_ui/web_ui.dart';
    
    import 'app.dart' as app;
    
    /**
     * An HTML representation of a page
     */
    class PageElement extends WebComponent {
      RouteHandle route;
      @observable String library;
      @observable String currentRouteName;
      
      inserted() {
        print('inserted');
        var homeRoute = route.getRoute('home');
        homeRoute.onRoute.listen((_) => currentRouteName = 'home');
        
        var libRoute = route.getRoute('libraryId');
        libRoute.onRoute.listen((RouteEvent e) {
          library = e.parameters['libraryId'];
          print('onRoute: ' + library);
          currentRouteName = 'library';
        });
      }
      
      removed() {
        route.discard();
      }
    }
  </script>
</element>